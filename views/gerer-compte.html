<div class="page-header">
    <h1 class="page-title">Gérer mon compte</h1>
</div>

<div class="card" style="max-width: 700px; cursor: default;">
    <div ng-if="loading" class="loading-spinner">Chargement...</div>

    <form name="accountForm" ng-submit="updateAccount()" ng-if="!loading" novalidate>

        <!-- Nom Complet -->
        <div class="form-group">
            <label for="fullName">Nom complet</label>
            <input type="text" id="fullName" name="fullName" class="form-control" ng-model="user.fullName" required>
        </div>

        <!-- Email -->
        <div class="form-group">
            <label for="email">Email</label>
            <input type="email" id="email" name="email" class="form-control" ng-model="user.email"
                ng-pattern="/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/" required>
            <div class="error-msg" ng-show="accountForm.email.$invalid && accountForm.email.$touched">
                Email invalide.
            </div>
        </div>

        <!-- Téléphone -->
        <div class="form-group">
            <label for="phone">Téléphone</label>
            <input type="text" id="phone" name="phone" class="form-control" ng-model="user.phone"
                placeholder="XX XX XX XX XX" ng-pattern="/^(\d{2} ){4}\d{2}$|^0\d{9}$/">
            <div class="error-msg" ng-show="accountForm.phone.$invalid && accountForm.phone.$touched">
                Format invalide (XX XX XX XX XX ou 0XXXXXXXXX).
            </div>
        </div>

        <!-- Notifications -->
        <div class="form-group">
            <label style="margin-bottom: 1rem;">Préférences de notification</label>
            <div style="display: flex; gap: 2rem;">
                <label style="display: flex; align-items: center; gap: 10px; font-weight: normal; cursor: pointer;">
                    <input type="checkbox" ng-model="user.notifications.email"> Email
                </label>
                <label style="display: flex; align-items: center; gap: 10px; font-weight: normal; cursor: pointer;">
                    <input type="checkbox" ng-model="user.notifications.sms"> SMS
                </label>
            </div>
        </div>

        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 1rem;">
            <!-- Submit -->
            <button type="submit" class="btn btn-primary" ng-disabled="accountForm.$invalid || saving">
                <span ng-show="!saving">Enregistrer</span>
                <span ng-show="saving"><i class="fa fa-spinner fa-spin"></i> Enregistrement...</span>
            </button>

            <!-- Delete Button -->
            <button type="button" class="btn" style="background: #ffebee; color: #c62828;" ng-click="deleteAccount()"
                ng-disabled="deleting">
                <i class="fa fa-trash"></i> Supprimer le compte
                <span ng-show="deleting">...</span>
            </button>
        </div>

        <!-- Messages -->
        <div ng-if="message.text"
            ng-class="{'success-msg': message.type === 'success', 'error-msg': message.type === 'error'}"
            style="margin-top: 15px; font-weight: bold;">
            {{ message.text }}
        </div>
    </form>
</div>